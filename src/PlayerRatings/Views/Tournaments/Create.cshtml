@using PlayerRatings.Localization
@model PlayerRatings.ViewModels.Tournament.TournamentEditViewModel
@inject Microsoft.Extensions.Localization.IStringLocalizer<LocalizationKey> LocString

@{
    ViewData["Title"] = LocString[nameof(LocalizationKey.CreateTournament)];
}

<form asp-action="Create" method="post">
    <div class="form-horizontal">
        <h2>@LocString[nameof(LocalizationKey.Tournament)]</h2>
        <h5 class="text-muted">@Model.LeagueName</h5>
        <hr />
        <input type="hidden" asp-for="LeagueId" />
        
        <div class="form-group">
            <label asp-for="Ordinal" class="col-md-2 control-label">@LocString[nameof(LocalizationKey.Ordinal)]</label>
            <div class="col-md-10">
                <input asp-for="Ordinal" class="form-control" placeholder="e.g., 4th or 2026" />
            </div>
        </div>
        
        <div class="form-group">
            <label asp-for="Name" class="col-md-2 control-label">@LocString[nameof(LocalizationKey.TournamentName)]</label>
            <div class="col-md-10">
                <input asp-for="Name" class="form-control" placeholder="e.g., SWA Dan Certification" />
                <span asp-validation-for="Name" class="text-danger"></span>
            </div>
        </div>
        
        <div class="form-group">
            <label asp-for="Group" class="col-md-2 control-label">@LocString[nameof(LocalizationKey.Group)] / @LocString[nameof(LocalizationKey.Title)]</label>
            <div class="col-md-10">
                <input asp-for="Group" class="form-control" id="groupInput" placeholder="e.g., Group A, Dan Group" />
                <span class="help-block" id="groupHelp" style="display: none;">Format: English Title - 中文头衔</span>
            </div>
        </div>
        
        <div class="form-group">
            <label asp-for="TournamentType" class="col-md-2 control-label">@LocString[nameof(LocalizationKey.Type)]</label>
            <div class="col-md-10">
                <select asp-for="TournamentType" class="form-control">
                    <option value="">-- Select Type --</option>
                    @foreach (var type in PlayerRatings.ViewModels.Tournament.TournamentEditViewModel.CommonTypes)
                    {
                        <option value="@type">@type</option>
                    }
                </select>
            </div>
        </div>
        
        <div class="form-group">
            <label asp-for="Organizer" class="col-md-2 control-label">@LocString[nameof(LocalizationKey.Organizer)]</label>
            <div class="col-md-10">
                <input asp-for="Organizer" class="form-control" placeholder="e.g., Singapore Weiqi Association" />
            </div>
        </div>
        
        <div class="form-group">
            <label asp-for="Location" class="col-md-2 control-label">@LocString[nameof(LocalizationKey.Location)]</label>
            <div class="col-md-10">
                <input asp-for="Location" class="form-control" placeholder="e.g., SWA Club" />
            </div>
        </div>
        
        <div class="form-group">
            <label asp-for="StartDate" class="col-md-2 control-label">@LocString[nameof(LocalizationKey.Start)]</label>
            <div class="col-md-10">
                <input asp-for="StartDate" type="date" class="form-control" />
            </div>
        </div>
        
        <div class="form-group">
            <label asp-for="EndDate" class="col-md-2 control-label">@LocString[nameof(LocalizationKey.End)]</label>
            <div class="col-md-10">
                <input asp-for="EndDate" type="date" class="form-control" />
            </div>
        </div>
        
        <div class="form-group">
            <label asp-for="Factor" class="col-md-2 control-label">@LocString[nameof(LocalizationKey.Factor)]</label>
            <div class="col-md-10">
                <input asp-for="Factor" type="number" step="0.1" class="form-control" placeholder="Leave empty for default" />
            </div>
        </div>
        
        <div class="form-group">
            <label asp-for="Photo" class="col-md-2 control-label">@LocString[nameof(LocalizationKey.PhotoUrl)]</label>
            <div class="col-md-10">
                <input asp-for="Photo" class="form-control" placeholder="URL to tournament photo" />
            </div>
        </div>
        
        <div class="form-group">
            <label asp-for="StandingsPhoto" class="col-md-2 control-label">@LocString[nameof(LocalizationKey.StandingsPhoto)]</label>
            <div class="col-md-10">
                <input asp-for="StandingsPhoto" class="form-control" placeholder="URL to original standings image" />
            </div>
        </div>
        
        <div class="form-group">
            <label asp-for="ExternalLinks" class="col-md-2 control-label">@LocString[nameof(LocalizationKey.ExternalLinks)]</label>
            <div class="col-md-10">
                <input asp-for="ExternalLinks" class="form-control" placeholder="URLs separated by semicolons" />
            </div>
        </div>
        
        <div class="form-group">
            <label asp-for="Notes" class="col-md-2 control-label">@LocString[nameof(LocalizationKey.Notes)]</label>
            <div class="col-md-10">
                <textarea asp-for="Notes" class="form-control" rows="3"></textarea>
            </div>
        </div>
        
        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <div class="checkbox">
                    <label>
                        <input asp-for="SupportsPersonalAward" /> @LocString[nameof(LocalizationKey.PersonalAward)]
                    </label>
                </div>
            </div>
        </div>
        
        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <div class="checkbox">
                    <label>
                        <input asp-for="SupportsTeamAward" /> @LocString[nameof(LocalizationKey.TeamAward)]
                    </label>
                </div>
            </div>
        </div>
        
        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <div class="checkbox">
                    <label>
                        <input asp-for="SupportsFemaleAward" /> @LocString[nameof(LocalizationKey.FemaleAward)]
                    </label>
                </div>
            </div>
        </div>
        
        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <button type="submit" class="btn btn-default">@LocString[nameof(LocalizationKey.CreateTournament)]</button>
                <a asp-action="Index" asp-route-leagueId="@Model.LeagueId" class="btn btn-default">@LocString[nameof(LocalizationKey.Cancel)]</a>
            </div>
        </div>
    </div>
</form>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    <script>
        $(function() {
            function updateGroupHelp() {
                var selectedType = $('#TournamentType').val();
                if (selectedType === 'Title') {
                    $('#groupInput').attr('placeholder', 'e.g., SG Qiwan - 新加坡棋王');
                    $('#groupHelp').show();
                } else {
                    $('#groupInput').attr('placeholder', 'e.g., Group A, Dan Group');
                    $('#groupHelp').hide();
                }
            }
            
            // Initial update based on current value
            updateGroupHelp();
            
            // Update when type changes
            $('#TournamentType').on('change', updateGroupHelp);
        });
    </script>
}
